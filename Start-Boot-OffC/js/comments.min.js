define(["jquery","core/theme-app","core/modules/comments"],function(e,t,n){e("#app-content-wrapper").on("submit","#comment-form",function(o){o.preventDefault();var s=e('#comment-form [type="submit"]');s.attr("disabled","disabled").text("Sending...");var a={content:e('#comment-form [name="content"]').val(),post:e('#comment-form [name="post"]').val()};n.postComment(a,function(n){s.removeAttr("disabled"),e('#comment-form [name="content"]').val(""),t.rerenderCurrentScreen(),window.scrollTo(0,0);var o=n.waiting_approval?"Your comment is awaiting moderation":"Comment added successfully :)";e("#feedback").removeClass("error").html(o).slideDown()},function(e){s.removeAttr("disabled").text("Submit comment"),window.scrollTo(0,0)})}),t.filter("theme-event-message",function(e,t){if("comment-error"==t.subtype)switch(t.event){case"comment:content-empty":e="Comment content is empty!";break;case"comment:already-said-that":e="Comment already posted.";break;default:e="Comment error :("}return e}),t.filter("stop-theme-event",function(e,t){if("comment-error"==t.subtype)switch(t.event){case"comment:user-connection-expired":case"comment:user-not-authenticated":e=!0}return e})});
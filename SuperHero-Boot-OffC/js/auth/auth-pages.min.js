define(["jquery","core/theme-app","core/modules/authentication"],function(e,t,n){t.addCustomRoute("user-page","user-page"),t.filter("redirect",function(e,o){if("user-page"==o.item_id){var a=n.getCurrentUser();a||(t.navigate("#"),e=!0)}return e}),t.filter("template-args",function(e,t,o){if("user-page"==o){var a=n.getCurrentUser();a&&(e.user={login:a.login,role:a.permissions.roles.pop(),capabilities:a.permissions.capabilities})}return e}),t.addCustomRoute("login-page","login-page"),e("#app-content-wrapper").on("click","#login-page button",function(t){t.preventDefault(),n.logUserIn(e("#user-login").val(),e("#user-pass").val())}),t.on("info",function(t){switch(t.event){case"auth:user-logout":var n="";switch(t.core_data.logout_type){case"user-connection-expired":n="Your connection has expired. Please log in again!";break;case"user-not-authenticated":n="Your connection has been reseted. Please log in again!"}n&&e("#feedback").removeClass("error").html(n).slideDown()}}),t.filter("theme-event-message",function(e,t){if("authentication-error"==t.subtype)switch(t.event){case"auth:empty-user":e="User login is empty";break;case"auth:wrong-user":e="User not found";break;case"auth:wrong-pass":e="User name and password do not match";break;default:e="User authentication failed :("}return e}),t.on("info:app-ready",function(){n.checkUserAuthenticationFromRemote(function(e){},function(e){})})});